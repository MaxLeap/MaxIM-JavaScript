{"version":3,"sources":["../src/im.ts"],"names":[],"mappings":";;IA4BA;QAKI,mBAAY,OAAqB;YAC7B,EAAE,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC3C,MAAM,IAAI,KAAK,CAAC,sBAAoB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAG,CAAC,CAAC;YACnE,CAAC;YAED,IAAI,MAAc,EAAE,QAAQ,GAAW,OAAO,CAAC,OAAO,GAAG,SAAS,GAAG,UAAU,CAAC;YAChF,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;gBAC7C,KAAK,IAAI;oBACL,MAAM,GAAG,gBAAgB,CAAC;oBAC1B,KAAK,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,GAAG,eAAe,CAAC;oBACzB,KAAK,CAAC;gBACV,KAAK,MAAM;oBACP,MAAM,GAAG,kBAAkB,CAAC;oBAC5B,KAAK,CAAC;gBACV;oBACI,MAAM,IAAI,KAAK,CAAC,oBAAkB,OAAO,CAAC,MAAQ,CAAC,CAAC;YAC5D,CAAC;YACD,IAAI,CAAC,QAAQ,GAAG,IAAI,mBAAU,CAAC,KAAG,QAAQ,GAAG,MAAQ,EAAE,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;YACjF,IAAI,CAAC,MAAM,GAAG,IAAI,iBAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC/C,CAAC;QAED,yBAAK,GAAL;YACI,MAAM,CAAC,IAAI,iBAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACxC,CAAC;QAED,6BAAS,GAAT,UAAU,EAAW;YACjB,MAAM,CAAC,IAAI,gCAAoB,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QACvD,CAAC;QAED,yBAAK,GAAL;YACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACvB,CAAC;QACL,gBAAC;IAAD,CAvCA,AAuCC,IAAA;IAED,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC;QAChC,IAAI,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,IAAI,CAAC;QACzB,EAAE,CAAC,CAAC,OAAO,MAAM,CAAC,EAAE,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;YACpC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;QACpB,CAAC;QACD,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,UAAU,OAAqB;YAC5C,MAAM,CAAC,IAAI,SAAS,CAAC,OAAO,CAAC,CAAA;QACjC,CAAC,CAAC;IACN,CAAC;IAED,OAAS,UAAC,OAAqB,IAAY,OAAA,IAAI,SAAS,CAAC,OAAO,CAAC,EAAtB,CAAsB,CAAC","file":"im.js","sourcesContent":["import {Admin, AdminImpl} from \"./service/admin\";\nimport {Login, LoginImpl} from \"./service/login\";\nimport {APIOptions} from \"./model/models\";\nimport {PassengerBuilder, PassengerBuilderImpl} from \"./service/passenger\";\n\ninterface MaxIMOptions {\n    app: string;\n    key: string;\n    region?: string;\n    useHttp?: boolean;\n}\n\ninterface MaxIM {\n    /**\n     * 登录\n     */\n    login(): Login;\n    /**\n     * 访客登录\n     * @param id 访客ID\n     */\n    passenger(id?: string): PassengerBuilder;\n    /**\n     * 获取管理接口\n     */\n    admin(): Admin;\n}\n\nclass MaxIMImpl implements MaxIM {\n\n    private _options: APIOptions;\n    private _admin: Admin;\n\n    constructor(options: MaxIMOptions) {\n        if (!options || !options.app || !options.key) {\n            throw new Error(`invalid options: ${JSON.stringify(options)}`);\n        }\n\n        let server: string, protocol: string = options.useHttp ? 'http://' : 'https://';\n        switch ((options.region || 'cn').toLowerCase()) {\n            case 'us':\n                server = 'im.maxleap.com';\n                break;\n            case 'cn':\n                server = 'im.maxleap.cn';\n                break;\n            case 'test':\n                server = 'imuat.maxleap.cn';\n                break;\n            default:\n                throw new Error(`invalid region ${options.region}`);\n        }\n        this._options = new APIOptions(`${protocol}${server}`, options.app, options.key);\n        this._admin = new AdminImpl(this._options);\n    }\n\n    login(): Login {\n        return new LoginImpl(this._options);\n    }\n\n    passenger(id?: string): PassengerBuilder {\n        return new PassengerBuilderImpl(this._options, id);\n    }\n\n    admin(): Admin {\n        return this._admin;\n    }\n}\n\nif (typeof window !== 'undefined') {\n    let ml = 'ML', im = 'im';\n    if (typeof window[ml] === 'undefined') {\n        window[ml] = {};\n    }\n    window[ml][im] = function (options: MaxIMOptions): MaxIM {\n        return new MaxIMImpl(options)\n    };\n}\n\nexport = (options: MaxIMOptions): MaxIM => new MaxIMImpl(options);"]}