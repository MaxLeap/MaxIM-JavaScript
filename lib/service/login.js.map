{"version":3,"sources":["../src/service/login.ts"],"names":[],"mappings":";AAAA,wBAAiD,WAAW,CAAC,CAAA;AAE7D,oBAAkB,eAAe,CAAC,CAAA;AA4BlC;IAKI,mBAAY,UAAsB;QAC9B,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;QAC3B,IAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAC/B,IAAI,GAAG,GAAG,SAAG,CAAC,KAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAM,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC;QACzD,IAAI,CAAC,UAAU,GAAG;YACd,GAAG,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG;YACtB,IAAI,EAAE,GAAG;SACZ,CAAA;IACL,CAAC;IAEc,iBAAO,GAAtB,UAAuB,MAAU,EAAE,MAAU;QACzC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC;IACL,CAAC;IAED,0BAAM,GAAN,UAAO,MAAc;QACjB,IAAI,QAAQ,GAAG;YACX,MAAM,EAAE,MAAM;SACjB,CAAC;QACF,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAC7C,MAAM,CAAC,IAAI,4BAAkB,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,iCAAa,GAAb,UAAc,QAAgB,EAAE,QAAgB;QAC5C,IAAI,QAAQ,GAAG;YACX,QAAQ,EAAE,QAAQ;YAClB,QAAQ,EAAE,QAAQ;SACrB,CAAC;QACF,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAC7C,MAAM,CAAC,IAAI,4BAAkB,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,2BAAO,GAAP,UAAQ,KAAa,EAAE,MAAc;QACjC,IAAI,QAAQ,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,QAAQ,EAAE,MAAM;SACnB,CAAC;QACF,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAC7C,MAAM,CAAC,IAAI,4BAAkB,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAC3D,CAAC;IACL,gBAAC;AAAD,CA9CA,AA8CC,IAAA;AA9CY,iBAAS,YA8CrB,CAAA","file":"login.js","sourcesContent":["import {SessionBuilder, SessionBuilderImpl} from \"./session\";\nimport {APIOptions} from \"../model/models\";\nimport {md5} from \"../helper/md5\";\n\n/**\n * 登录器\n */\nexport interface Login {\n    /**\n     * 极简登录\n     * @param userid 用户ID\n     */\n    simple(userid: string): SessionBuilder;\n    /**\n     * 通过MaxLeap用户账号登录\n     * @param username 用户名\n     * @param password 密码\n     */\n    byMaxleapUser(username: string, password: string): SessionBuilder;\n    /**\n     * 通过手机号登录\n     * @param phone 手机号码\n     * @param verify 验证码\n     */\n    byPhone(phone: string, verify: string): SessionBuilder;\n}\n\n/**\n * 登录器实现类\n */\nexport class LoginImpl implements Login {\n\n    private _options: APIOptions;\n    private _basicAuth: {};\n\n    constructor(apiOptions: APIOptions) {\n        this._options = apiOptions;\n        let foo = new Date().getTime();\n        let bar = md5(`${foo}${this._options.sign}`) + ',' + foo;\n        this._basicAuth = {\n            app: this._options.app,\n            sign: bar\n        }\n    }\n\n    private static _extend(target: {}, source: {}): void {\n        for (let k in source) {\n            target[k] = source[k];\n        }\n    }\n\n    simple(userid: string): SessionBuilder {\n        let authdata = {\n            client: userid\n        };\n        LoginImpl._extend(authdata, this._basicAuth);\n        return new SessionBuilderImpl(this._options, authdata);\n    }\n\n    byMaxleapUser(username: string, password: string): SessionBuilder {\n        let authdata = {\n            username: username,\n            password: password\n        };\n        LoginImpl._extend(authdata, this._basicAuth);\n        return new SessionBuilderImpl(this._options, authdata);\n    }\n\n    byPhone(phone: string, verify: string): SessionBuilder {\n        let authdata = {\n            phone: phone,\n            password: verify\n        };\n        LoginImpl._extend(authdata, this._basicAuth);\n        return new SessionBuilderImpl(this._options, authdata);\n    }\n}"]}